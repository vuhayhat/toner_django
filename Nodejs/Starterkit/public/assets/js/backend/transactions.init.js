var perPage=10,editlist=!1,options={valueNames:["id","vatId","clientName","cleintEmail","type","transactionID","amount","paymentMethod","transactionDate","status"],page:perPage,pagination:!0,plugins:[ListPagination({left:2,right:2})]},transactionsList=new List("transactionsList",options).on("updated",(function(e){0==e.matchingItems.length?document.getElementsByClassName("noresult")[0].style.display="block":document.getElementsByClassName("noresult")[0].style.display="none";var t=1==e.i,a=e.i>e.matchingItems.length-e.page;document.querySelector(".pagination-prev.disabled")&&document.querySelector(".pagination-prev.disabled").classList.remove("disabled"),document.querySelector(".pagination-next.disabled")&&document.querySelector(".pagination-next.disabled").classList.remove("disabled"),t&&document.querySelector(".pagination-prev").classList.add("disabled"),a&&document.querySelector(".pagination-next").classList.add("disabled"),e.matchingItems.length<=perPage?document.querySelector(".pagination-wrap").style.display="none":document.querySelector(".pagination-wrap").style.display="flex",e.matchingItems.length==perPage&&document.querySelector(".pagination.listjs-pagination").firstElementChild.children[0].click(),e.matchingItems.length>0?document.getElementsByClassName("noresult")[0].style.display="none":document.getElementsByClassName("noresult")[0].style.display="block"})),idField=document.getElementById("id-field"),clientNameField=document.getElementById("clientName-field"),clientEmailField=document.getElementById("cleintEmail-field"),typeField=document.getElementById("type-field"),transactionIDField=document.getElementById("transactionID-field"),vatField=document.getElementById("vatID-field"),amountField=document.getElementById("amount-field"),paymentMethodField=document.getElementById("paymentMethod-field"),transactionDateField=document.getElementById("transactionDate-field"),statusField=document.getElementById("statusSelect"),addBtn=document.getElementById("add-btn"),viewBtns=document.getElementsByClassName("view-item-btn"),editBtn=document.getElementById("edit-btn");refreshCallbacks();var typeVal=new Choices(typeField,{searchEnabled:!1}),statusVal=new Choices(statusField,{searchEnabled:!1});const values=[{value:"American Express",label:'<img src="../assets/images/ecommerce/payment/american-express.png" class="avatar-xxs me-1"/> American Express',id:1},{value:"PayPal",label:'<img src="../assets/images/ecommerce/payment/paypal.png" class="avatar-xxs me-1"/> American PayPal',id:2},{value:"Discover",label:'<img src="../assets/images/ecommerce/payment/discover.png" class="avatar-xxs me-1"/> Discover',id:3},{value:"Visa Credit/Debit",label:'<img src="../assets/images/ecommerce/payment/visa.png" class="avatar-xxs me-1"/> Visa Credit/Debit',id:4}];var paymentElement=document.querySelector("#paymentMethod-field"),paymentMethodVal=new Choices(paymentElement,{choices:values,searchEnabled:!1}),count=11,forms=document.querySelectorAll(".tablelist-form");Array.prototype.slice.call(forms).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault();var t,a=document.getElementById("alert-error-msg");a.classList.remove("d-none"),setTimeout((()=>a.classList.add("d-none")),2e3);return""==clientNameField.value?(t="Please enter Client name",a.innerHTML=t,!1):clientEmailField.value.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)?""==typeField.value?(t="Please select a type",a.innerHTML=t,!1):""==transactionIDField.value?(t="Please enter a transaction ID",a.innerHTML=t,!1):""==vatField.value?(t="Please enter Vat ID",a.innerHTML=t,!1):""==amountField.value?(t="Please select a type",a.innerHTML=t,!1):""==paymentMethodField.value?(t="Please Select Payment Method",a.innerHTML=t,!1):""==transactionDateField.value?(t="Please select transaction date",a.innerHTML=t,!1):""==statusField.value?(t="Please select transaction",a.innerHTML=t,!1):(""===clientNameField.value||""===clientEmailField.value||""===typeField.value||""===transactionIDField.value||""===vatField.value||""===amountField.value||""===paymentMethodField.value||""===transactionDateField.value||""===statusField.value||editlist||(transactionsList.add({id:`<a href="javascript:void(0);" class="fw-medium link-primary">${count}</a>`,clientName:clientNameField.value,cleintEmail:clientEmailField.value,type:isTypeIcon(typeField.value),transactionID:`<a href="#!" class="fw-medium">${transactionIDField.value}</a>`,vatId:vatField.value,amount:amountField.value,paymentMethod:isPaymentMethod(paymentMethodField.value),transactionDate:transactionDateField.value,status:isStatus(statusField.value)}),transactionsList.sort("id",{order:"desc"}),document.getElementById("alert-error-msg").classList.add("d-none"),document.getElementById("close-modal").click(),clearFields(),refreshCallbacks(),count++,Swal.fire({position:"center",icon:"success",title:"Transaction added successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0})),!0):(t="Please enter valid email address",a.innerHTML=t,!1)}))}));const xhttp=new XMLHttpRequest;function refreshCallbacks(){viewBtns&&Array.from(viewBtns).forEach((function(e){e.addEventListener("click",(function(e){e.target.closest("tr").children[0].innerText,itemId=e.target.closest("tr").children[0].innerText;var t=transactionsList.get({id:itemId});Array.from(t).forEach((function(e){isid=(new DOMParser).parseFromString(e._values.id,"text/html");var t=isid.body.firstElementChild.innerHTML,a=(new DOMParser).parseFromString(e._values.transactionID,"text/html").body.firstElementChild.innerHTML,n=(new DOMParser).parseFromString(e._values.paymentMethod,"text/html"),s=n.body.querySelector(".paycard-image").src,i=n.body.querySelector(".paycard").innerHTML;if(t==itemId){var l=`<div class="table-responsive table-card">\n                        <table class="table table-borderless align-middle">\n                            <tr>\n                                <td style="width: 150px;">\n                                    <span class="text-muted text-uppercase">Transaction ID</span>\n                                </td>\n                                <td>\n                                    <span class="fw-semibold">${a}</span>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>\n                                    <span class="text-muted text-uppercase">Date</span>\n                                </td>\n                                <td>\n                                    <span class="fw-semibold">${e._values.transactionDate}</span>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>\n                                    <span class="text-muted text-uppercase">VAT ID:</span>\n                                </td>\n                                <td>\n                                    <span class="fw-semibold">${e._values.vatId}</span>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>\n                                    <span class="text-muted text-uppercase">Client Name</span>\n                                </td>\n                                <td>\n                                    <span class="fw-semibold">${e._values.clientName}</span>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>\n                                    <span class="text-muted text-uppercase">Email ID</span>\n                                </td>\n                                <td>\n                                    <div class="fw-semibold">${e._values.cleintEmail}</div>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>\n                                    <span class="text-muted text-uppercase">Amount</span>\n                                </td>\n                                <td>\n                                    <span class="fw-semibold">${e._values.amount}</span>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>\n                                    <span class="text-muted text-uppercase">Payment Method</span>\n                                </td>\n                                <td>\n                                    <div class="d-flex align-items-center gap-2">\n                                        <div class="flex-shrink-0">\n                                            <img src="${s}" alt="" class="avatar-xs object-fit-cover">\n                                        </div>\n                                        <div class="flex-grow-1">\n                                            <h6 class="mb-0">${i}</h6>\n                                        </div>\n                                    </div>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>\n                                    <span class="text-muted text-uppercase">Status</span>\n                                </td>\n                                <td>\n                                    ${e._values.status}\n                                </td>\n                            </tr>\n                        </table>\n                    </div>\n                    <div class="mt-3 hstack gap-2">\n                        <button type="button" class="btn btn-soft-danger w-100">Download Receipt</button>\n                        <button type="button" class="btn btn-soft-secondary w-100">All Statement</button>\n                    </div>`;document.getElementById("transactionDetails").innerHTML=l}}))}))}))}function isTypeIcon(e){switch(e){case"up":return'<i class="bx bx-trending-'+e+' align-middle text-success"></i>';case"down":return'<i class="bx bx-trending-'+e+' align-middle text-danger"></i>'}}function isStatus(e){switch(e){case"Successful":return'<span class="badge bg-success-subtle text-success ">'+e+"</span>";case"Pending":return'<span class="badge bg-warning-subtle text-warning ">'+e+"</span>";case"Denied":return'<span class="badge bg-danger-subtle text-danger ">'+e+"</span>"}}function isPaymentMethod(e){switch(e){case"American Express":return`<div class="d-flex align-items-center gap-2">\n                    <div class="flex-shrink-0">\n                        <img src="../assets/images/ecommerce/payment/american-express.png" alt="" class="avatar-xs object-fit-cover paycard-image">\n                    </div>\n                    <div class="flex-grow-1">\n                        <h6 class="mb-0 paycard">${e}</h6>\n                    </div>\n                </div>`;case"PayPal":return`<div class="d-flex align-items-center gap-2">\n                    <div class="flex-shrink-0">\n                        <img src="../assets/images/ecommerce/payment/paypal.png" alt="" class="avatar-xs object-fit-cover paycard-image">\n                    </div>\n                    <div class="flex-grow-1">\n                        <h6 class="mb-0 paycard">${e}</h6>\n                    </div>\n                </div>`;case"Discover":return`<div class="d-flex align-items-center gap-2">\n                    <div class="flex-shrink-0">\n                        <img src="../assets/images/ecommerce/payment/discover.png" alt="" class="avatar-xs object-fit-cover paycard-image">\n                    </div>\n                    <div class="flex-grow-1">\n                        <h6 class="mb-0 paycard">${e}</h6>\n                    </div>\n                </div>`;case"Visa Credit/Debit":return`<div class="d-flex align-items-center gap-2">\n                    <div class="flex-shrink-0">\n                        <img src="../assets/images/ecommerce/payment/visa.png" alt="" class="avatar-xs object-fit-cover paycard-image">\n                    </div>\n                    <div class="flex-grow-1">\n                        <h6 class="mb-0 paycard">${e}</h6>\n                    </div>\n                </div>`}}function clearFields(){clientNameField.value="",clientEmailField.value="",transactionIDField.value="",vatField.value="",amountField.value="",transactionDateField.value="",typeVal&&typeVal.destroy(),typeVal=new Choices(typeField),statusVal&&statusVal.destroy(),statusVal=new Choices(statusField),paymentMethodVal&&paymentMethodVal.destroy(),paymentMethodVal=new Choices(paymentElement,{choices:values,searchEnabled:!1})}function filterData(){var e=document.getElementById("idStatus").value,t=document.getElementById("demo-datepicker").value,a=t.split(" to ")[0],n=t.split(" to ")[1];transactionsList.filter((function(s){matchData=(new DOMParser).parseFromString(s.values().status,"text/html");var i=matchData.body.firstElementChild.innerHTML,l=!1,d=!1;return l="all"==i||"all"==e||i==e,d=new Date(s.values().transactionDate)>=new Date(a)&&new Date(s.values().transactionDate)<=new Date(n),l&&d?l&&d:l&&""==t?l:d&&""!==t?d:void 0})),transactionsList.update()}xhttp.onload=function(){var e=JSON.parse(this.responseText);Array.from(e).forEach((function(e){transactionsList.add({id:`<a href="javascript:void(0);" class="fw-medium link-primary">#TB${e.id}</a>`,vatId:e.vatId,clientName:e.clientName,cleintEmail:e.cleintEmail,type:isTypeIcon(e.type),transactionID:`<a href="#!" class="fw-medium">${e.transactionID}</a>`,amount:e.amount,paymentMethod:'<div class="d-flex align-items-center gap-2">                            <div class="flex-shrink-0">                                <img src="'+e.paymentMethod[0]+'" alt="" class="avatar-xs object-fit-cover paycard-image">                            </div>                            <div class="flex-grow-1">                                <h6 class="mb-0 paycard">'+e.paymentMethod[1]+"</h6>                            </div>                        </div>",transactionDate:e.transactionDate,status:isStatus(e.status)}),transactionsList.sort("id",{order:"desc"}),refreshCallbacks()})),transactionsList.remove("id",'<a href="javascript:void(0);" class="fw-medium link-primary">#TB01</a>')},xhttp.open("GET","../assets/json/transactions-list.json"),xhttp.send(),document.getElementById("showModal").addEventListener("hidden.bs.modal",(function(){clearFields()})),document.querySelector(".pagination-next").addEventListener("click",(function(){document.querySelector(".pagination.listjs-pagination")&&(document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").nextElementSibling.children[0].click())})),document.querySelector(".pagination-prev").addEventListener("click",(function(){document.querySelector(".pagination.listjs-pagination")&&(document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").previousSibling.children[0].click())}));