var perPage=10,editlist=!1,options={valueNames:["id","discount","couponTitle","code","productType","startDate","endDate","status"],page:perPage,pagination:!0,plugins:[ListPagination({left:2,right:2})]},couponsList=new List("couponsList",options).on("updated",(function(e){0==e.matchingItems.length?document.getElementsByClassName("noresult")[0].style.display="block":document.getElementsByClassName("noresult")[0].style.display="none";var t=1==e.i,n=e.i>e.matchingItems.length-e.page;document.querySelector(".pagination-prev.disabled")&&document.querySelector(".pagination-prev.disabled").classList.remove("disabled"),document.querySelector(".pagination-next.disabled")&&document.querySelector(".pagination-next.disabled").classList.remove("disabled"),t&&document.querySelector(".pagination-prev").classList.add("disabled"),n&&document.querySelector(".pagination-next").classList.add("disabled"),e.matchingItems.length<=perPage?document.querySelector(".pagination-wrap").style.display="none":document.querySelector(".pagination-wrap").style.display="flex",e.matchingItems.length==perPage&&document.querySelector(".pagination.listjs-pagination").firstElementChild.children[0].click(),e.matchingItems.length>0?document.getElementsByClassName("noresult")[0].style.display="none":document.getElementsByClassName("noresult")[0].style.display="block"}));const xhttp=new XMLHttpRequest;xhttp.onload=function(){var e=JSON.parse(this.responseText);Array.from(e).forEach((function(e){couponsList.add({id:`<a href="javascript:void(0);" class="fw-medium link-primary">#TB${e.id}</a>`,discount:`<h5 class="mb-0 fs-16">${e.discount}</h5>`,couponTitle:e.couponTitle,code:e.code,startDate:e.startDate,endDate:e.endDate,productType:isProductType(e.productType),status:isStatus(e.status)}),couponsList.sort("id",{order:"desc"}),refreshCallbacks()})),couponsList.remove("id",'<a href="javascript:void(0);" class="fw-medium link-primary">#TB01</a>')},xhttp.open("GET","../assets/json/coupons-list.json"),xhttp.send();var idField=document.getElementById("id-field"),couponTitleField=document.getElementById("couponTitle-field"),codeField=document.getElementById("code-field"),productTypeField=document.getElementById("productType-field"),startDateField=document.getElementById("startdate-field"),endDateField=document.getElementById("enddate-field"),discountField=document.getElementById("discount-field"),statusField=document.getElementById("status-Field");addBtn=document.getElementById("add-btn"),editBtn=document.getElementById("edit-btn"),removeBtns=document.getElementsByClassName("remove-item-btn"),viewBtns=document.getElementsByClassName("view-item-btn"),editBtns=document.getElementsByClassName("edit-item-btn"),refreshCallbacks();var productTypeVal=new Choices(productTypeField),statusVal=new Choices(statusField);document.getElementById("showModal").addEventListener("show.bs.modal",(function(e){e.relatedTarget.classList.contains("edit-item-btn")?(document.getElementById("exampleModalLabel").innerHTML="Update Coupon",document.getElementById("showModal").querySelector(".modal-footer").style.display="block",document.getElementById("add-btn").innerHTML="Update Coupon"):e.relatedTarget.classList.contains("add-btn")?(document.getElementById("exampleModalLabel").innerHTML="Add Coupen",document.getElementById("showModal").querySelector(".modal-footer").style.display="block",document.getElementById("add-btn").innerHTML="Add Coupen"):(document.getElementById("exampleModalLabel").innerHTML="List Order",document.getElementById("showModal").querySelector(".modal-footer").style.display="none")}));var count=13,forms=document.querySelectorAll(".tablelist-form");function refreshCallbacks(){removeBtns&&Array.from(removeBtns).forEach((function(e){e.addEventListener("click",(function(e){e.target.closest("tr").children[0].innerText,itemId=e.target.closest("tr").children[0].innerText;var t=couponsList.get({id:itemId});Array.from(t).forEach((function(e){deleteid=(new DOMParser).parseFromString(e._values.id,"text/html");var t=deleteid.body.firstElementChild;deleteid.body.firstElementChild.innerHTML==itemId&&document.getElementById("delete-record").addEventListener("click",(function(){couponsList.remove("id",t.outerHTML),document.getElementById("deleteRecord-close").click(),Swal.fire({position:"center",icon:"success",title:"Coupon deleted successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0})}))}))}))})),editBtns&&Array.from(editBtns).forEach((function(e){e.addEventListener("click",(function(e){e.target.closest("tr").children[0].innerText,itemId=e.target.closest("tr").children[0].innerText;var t=couponsList.get({id:itemId});Array.from(t).forEach((function(e){isid=(new DOMParser).parseFromString(e._values.id,"text/html");var t=isid.body.firstElementChild.innerHTML;if(t==itemId){editlist=!0,idField.value=t,couponTitleField.value=e._values.couponTitle,codeField.value=e._values.code,discountVal=(new DOMParser).parseFromString(e._values.discount,"text/html"),discountField.value=discountVal.body.firstElementChild.innerHTML,statusVal&&statusVal.destroy(),statusVal=new Choices(statusField,{searchEnabled:!1}),val=(new DOMParser).parseFromString(e._values.status,"text/html");var n=val.body.firstElementChild.innerHTML;statusVal.setChoiceByValue(n),productTypeVal&&productTypeVal.destroy(),productTypeVal=new Choices(productTypeField,{searchEnabled:!1});var a=e._values.productType;productTypeVal.setChoiceByValue(a),flatpickr("#startdate-field",{dateFormat:"d M, Y",defaultDate:e._values.startDate}),flatpickr("#enddate-field",{dateFormat:"d M, Y",defaultDate:e._values.endDate})}}))}))})),viewBtns&&Array.from(viewBtns).forEach((function(e){e.addEventListener("click",(function(e){e.target.closest("tr").children[0].innerText,itemId=e.target.closest("tr").children[0].innerText;var t=couponsList.get({id:itemId});Array.from(t).forEach((function(e){isid=(new DOMParser).parseFromString(e._values.id,"text/html");var t=isid.body.firstElementChild.innerHTML;if(console.log("isid",t),t==itemId){var n=`\n                <div class="offcanvas-header bg-warning-subtle">\n                        <h5 class="offcanvas-title" id="couponDetails">${e._values.couponTitle}</h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>\n                    </div>\n                <div class="offcanvas-body">\n                <div>\n                    <img src="../assets/images/ecommerce/offer-banner.jpg" alt="" class="img-thumbnail">\n                </div>\n                <div class="mt-3">\n                    <div class="table-responsive">\n                        <table class="table table-borderless">\n                            <tr>\n                                <td><span class="text-muted">Use Code</span></td>\n                                <td><span class="fw-medium">${e._values.code}</span></td>\n                            </tr>\n                            <tr>\n                                <td><span class="text-muted">Discount</span></td>\n                                <td><span class="fw-medium text-uppercase">${(new DOMParser).parseFromString(e._values.discount,"text/html").body.firstElementChild.innerHTML}</span></td>\n                            </tr>\n                            <tr>\n                                <td><span class="text-muted">Start Date</span></td>\n                                <td><span class="fw-medium">09 Dec, 2022</span></td>\n                            </tr>\n                            <tr>\n                                <td><span class="text-muted">END Date</span></td>\n                                <td><span class="fw-medium">${e._values.endDate}</span></td>\n                            </tr>\n                            <tr>\n                                <td><span class="text-muted">Product Type</span></td>\n                                <td><span class="fw-medium">${e._values.productType}</span></td>\n                            </tr>\n                            <tr>\n                                <td><span class="text-muted">Status</span></td>\n                                <td>${e._values.status}</td>\n                            </tr>\n                        </table>\n                    </div>\n                </div>\n            </div>`;document.getElementById("couponDetails").innerHTML=n}}))}))}))}function isStatus(e){switch(e){case"Active":return'<span class="badge bg-success-subtle text-success  text-uppercase">'+e+"</span>";case"Expired":return'<span class="badge bg-danger-subtle text-danger  text-uppercase">'+e+"</span>"}}function isProductType(e){switch(e){case"Headphones":case"Watch":case"Furniture":case"Clothing":case"Footwear":case"Lighting":case"Beauty & Personal Care":case"Books":case"Other Accessories":return e}}function clearFields(){couponTitleField.value="",codeField.value="",startDateField.value="",endDateField.value="",discountField.value="",productTypeVal&&productTypeVal.destroy(),productTypeVal=new Choices(productTypeField),statusVal&&statusVal.destroy(),statusVal=new Choices(statusField)}Array.prototype.slice.call(forms).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault();var t,n=document.getElementById("alert-error-msg");if(n.classList.remove("d-none"),setTimeout((()=>n.classList.add("d-none")),2e3),""==couponTitleField.value)return t="Please enter a coupon title",n.innerHTML=t,!1;if(""==codeField.value)return t="Please enter a code",n.innerHTML=t,!1;if(""==productTypeField.value)return t="Please select a product type",n.innerHTML=t,!1;if(""==startDateField.value)return t="Please select a start date",n.innerHTML=t,!1;if(""==endDateField.value)return t="Please select a end date",n.innerHTML=t,!1;if(""==discountField.value)return t="Please enter discount",n.innerHTML=t,!1;if(""==statusField.value)return t="Please select a delivery status",n.innerHTML=t,!1;if(""===couponTitleField.value||""===codeField.value||""===productTypeField.value||""===startDateField.value||""===endDateField.value||""===discountField.value||""===statusField.value||editlist){if(""!==couponTitleField.value&&""!==codeField.value&&""!==productTypeField.value&&""!==startDateField.value&&""!==endDateField.value&&""!==statusField.value&&""!==discountField.value&&editlist){var a=couponsList.get({id:idField.value});Array.from(a).forEach((function(e){isid=(new DOMParser).parseFromString(e._values.id,"text/html"),isid.body.firstElementChild.innerHTML==itemId&&e.values({id:'<a href="javascript:void(0);" class="fw-medium link-primary">#TB'+idField.value+"</a>",couponTitle:couponTitleField.value,code:codeField.value,productType:productTypeField.value,startDate:startDateField.value,endDate:endDateField.value,discount:`<h5 class="mb-0 fs-16">${discountField.value}</h5>`,status:isStatus(statusField.value)})})),document.getElementById("alert-error-msg").classList.add("d-none"),document.getElementById("close-modal").click(),clearFields(),Swal.fire({position:"center",icon:"success",title:"Order updated Successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0})}}else couponsList.add({id:'<a href="javascript:void(0);" class="fw-medium link-primary">#TB'+count+"</a>",couponTitle:couponTitleField.value,code:codeField.value,productType:productTypeField.value,startDate:startDateField.value,endDate:endDateField.value,discount:`<h5 class="mb-0 fs-16">${discountField.value}</h5>`,status:isStatus(statusField.value)}),couponsList.sort("id",{order:"desc"}),document.getElementById("alert-error-msg").classList.add("d-none"),document.getElementById("close-modal").click(),clearFields(),refreshCallbacks(),count++,Swal.fire({position:"center",icon:"success",title:"Coupon added successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0});return!0}))})),document.getElementById("showModal").addEventListener("hidden.bs.modal",(function(){clearFields()})),document.querySelector(".pagination-next").addEventListener("click",(function(){document.querySelector(".pagination.listjs-pagination")&&(document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").nextElementSibling.children[0].click())})),document.querySelector(".pagination-prev").addEventListener("click",(function(){document.querySelector(".pagination.listjs-pagination")&&(document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").previousSibling.children[0].click())}));