var perPage=10,editlist=!1,options={valueNames:["id","customer_name","product_name","amount","order_date","delivery_date","payment_method","status"],page:perPage,pagination:!0,plugins:[ListPagination({left:2,right:2})]},orderList=new List("orderList",options).on("updated",(function(e){0==e.matchingItems.length?document.getElementsByClassName("noresult")[0].style.display="block":document.getElementsByClassName("noresult")[0].style.display="none";var t=1==e.i,a=e.i>e.matchingItems.length-e.page;document.querySelector(".pagination-prev.disabled")&&document.querySelector(".pagination-prev.disabled").classList.remove("disabled"),document.querySelector(".pagination-next.disabled")&&document.querySelector(".pagination-next.disabled").classList.remove("disabled"),t&&document.querySelector(".pagination-prev").classList.add("disabled"),a&&document.querySelector(".pagination-next").classList.add("disabled"),e.matchingItems.length<=perPage?document.querySelector(".pagination-wrap").style.display="none":document.querySelector(".pagination-wrap").style.display="flex",e.matchingItems.length==perPage&&document.querySelector(".pagination.listjs-pagination").firstElementChild.children[0].click(),e.matchingItems.length>0?document.getElementsByClassName("noresult")[0].style.display="none":document.getElementsByClassName("noresult")[0].style.display="block"}));const xhttp=new XMLHttpRequest;xhttp.onload=function(){var e=JSON.parse(this.responseText);Array.from(e).forEach((function(e){orderList.add({id:'<a href="javascript:void(0);" class="fw-medium link-primary">#TBT'+e.id+"</a>",customer_name:e.customer_name,product_name:e.product_name,amount:e.amount,order_date:e.order_date,delivery_date:e.delivery_date,payment_method:e.payment_method,status:isStatus(e.status)}),orderList.sort("id",{order:"desc"}),refreshCallbacks()})),orderList.remove("id",'<a href="javascript:void(0);" class="fw-medium link-primary">#TBT42101</a>')},xhttp.open("GET","../assets/json/orders-list.init.json"),xhttp.send(),isCount=(new DOMParser).parseFromString(orderList.items.slice(-1)[0]._values.id,"text/html");var isValue=isCount.body.firstElementChild.innerHTML;function isStatus(e){switch(e){case"Delivered":return'<span class="badge bg-success-subtle text-success  text-uppercase">'+e+"</span>";case"Cancelled":return'<span class="badge bg-danger-subtle text-danger  text-uppercase">'+e+"</span>";case"Inprogress":return'<span class="badge bg-secondary-subtle text-secondary  text-uppercase">'+e+"</span>";case"Pickups":return'<span class="badge bg-info-subtle text-info  text-uppercase">'+e+"</span>";case"Returns":return'<span class="badge bg-primary-subtle text-primary  text-uppercase">'+e+"</span>";case"Pending":return'<span class="badge bg-warning-subtle text-warning  text-uppercase">'+e+"</span>"}}var idField=document.getElementById("orderId"),customerNameField=document.getElementById("customername-field"),productNameField=document.getElementById("productname-field"),createDateField=document.getElementById("createdate-field"),deliveryDateField=document.getElementById("deliverydate-field"),amountField=document.getElementById("amount-field"),paymentField=document.getElementById("payment-field"),statusField=document.getElementById("delivered-status"),addBtn=document.getElementById("add-btn");editBtn=document.getElementById("edit-btn"),removeBtns=document.getElementsByClassName("remove-item-btn"),editBtns=document.getElementsByClassName("edit-item-btn"),refreshCallbacks();var paymentVal=new Choices(paymentField,{searchEnabled:!1}),statusVal=new Choices(statusField,{searchEnabled:!1}),productnameVal=new Choices(productNameField,{searchEnabled:!1});function refreshCallbacks(){removeBtns&&Array.from(removeBtns).forEach((function(e){e.addEventListener("click",(function(e){e.target.closest("tr").children[1].innerText,itemId=e.target.closest("tr").children[1].innerText;var t=orderList.get({id:itemId});Array.from(t).forEach((function(e){deleteid=(new DOMParser).parseFromString(e._values.id,"text/html");var t=deleteid.body.firstElementChild;deleteid.body.firstElementChild.innerHTML==itemId&&document.getElementById("delete-record").addEventListener("click",(function(){orderList.remove("id",t.outerHTML),document.getElementById("deleteRecord-close").click()}))}))}))})),editBtns&&Array.from(editBtns).forEach((function(e){e.addEventListener("click",(function(e){e.target.closest("tr").children[1].innerText,itemId=e.target.closest("tr").children[1].innerText;var t=orderList.get({id:itemId});Array.from(t).forEach((function(e){isid=(new DOMParser).parseFromString(e._values.id,"text/html");var t=isid.body.firstElementChild.innerHTML;if(t==itemId){editlist=!0,idField.value=t,customerNameField.value=e._values.customer_name,productNameField.value=e._values.product_name,amountField.value=e._values.amount,createDateField.value=e._values.order_date,deliveryDateField.value=e._values.delivery_date,amountField.value=e._values.amount,paymentVal&&paymentVal.destroy(),paymentVal=new Choices(paymentField,{searchEnabled:!1});var a=e._values.payment_method;paymentVal.setChoiceByValue(a),productnameVal&&productnameVal.destroy(),productnameVal=new Choices(productNameField,{searchEnabled:!1});var l=e._values.product_name;productnameVal.setChoiceByValue(l),statusVal&&statusVal.destroy(),statusVal=new Choices(statusField,{searchEnabled:!1}),val=(new DOMParser).parseFromString(e._values.status,"text/html");var d=val.body.firstElementChild.innerHTML;statusVal.setChoiceByValue(d),flatpickr("#createdate-field",{dateFormat:"d M, Y",defaultDate:e._values.order_date}),flatpickr("#deliverydate-field",{dateFormat:"d M, Y",defaultDate:e._values.delivery_date})}}))}))}))}document.getElementById("showModal").addEventListener("show.bs.modal",(function(e){e.relatedTarget.classList.contains("edit-item-btn")?(document.getElementById("modal-id").style.display="block",document.getElementById("exampleModalLabel").innerHTML="Edit Order",document.getElementById("showModal").querySelector(".modal-footer").style.display="block",document.getElementById("add-btn").innerHTML="Update"):e.relatedTarget.classList.contains("add-btn")?(document.getElementById("modal-id").style.display="none",document.getElementById("exampleModalLabel").innerHTML="Add Order",document.getElementById("showModal").querySelector(".modal-footer").style.display="block",document.getElementById("add-btn").innerHTML="Add Order"):(document.getElementById("exampleModalLabel").innerHTML="List Order",document.getElementById("showModal").querySelector(".modal-footer").style.display="none")}));var count=13,forms=document.querySelectorAll(".tablelist-form");function filterData(){var e=document.getElementById("idStatus").value,t=document.getElementById("idPayment").value,a=document.getElementById("demo-datepicker").value,l=a.split(" to ")[0],d=a.split(" to ")[1];orderList.filter((function(n){matchData=(new DOMParser).parseFromString(n.values().status,"text/html");var r=matchData.body.firstElementChild.innerHTML,i=!1,s=!1,o=!1;return i="all"==r||"all"==e||r==e,s="all"==n.values().payment||"all"==t||n.values().payment==t,o=new Date(n.values().order_date)>=new Date(l)&&new Date(n.values().order_date)<=new Date(d),i&&s&&o?i&&s&&o:i&&s&&""==a?i&&s:s&&o&&""==a?s&&o:void 0})),orderList.update()}function clearFields(){idField.value="",customerNameField.value="",productNameField.value="",createDateField.value="",deliveryDateField.value="",amountField.value="",paymentField.value="",flatpickr("#createdate-field").clear(),flatpickr("#deliverydate-field").clear(),paymentVal&&paymentVal.destroy(),paymentVal=new Choices(paymentField),productnameVal&&productnameVal.destroy(),productnameVal=new Choices(productNameField),statusVal&&statusVal.destroy(),statusVal=new Choices(statusField)}Array.prototype.slice.call(forms).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault();var t,a=document.getElementById("alert-error-msg");if(a.classList.remove("d-none"),setTimeout((()=>a.classList.add("d-none")),2e3),""==customerNameField.value)return t="Please enter a customer name",a.innerHTML=t,!1;if(""==productNameField.value)return t="Please select a products",a.innerHTML=t,!1;if(""==createDateField.value)return t="Please select a order date",a.innerHTML=t,!1;if(""==deliveryDateField.value)return t="Please select a delivery date",a.innerHTML=t,!1;if(""==amountField.value)return t="Please enter a amount",a.innerHTML=t,!1;if(""==paymentField.value)return t="Please select a payment method",a.innerHTML=t,!1;if(""==statusField.value)return t="Please select a delivery status",a.innerHTML=t,!1;if(""===customerNameField.value||""===productNameField.value||""===createDateField.value||""===deliveryDateField.value||""===amountField.value||""===statusField.value||""===paymentField.value||editlist){if(""!==customerNameField.value&&""!==productNameField.value&&""!==createDateField.value&&""!==deliveryDateField.value&&""!==amountField.value&&""!==statusField.value&&""!==paymentField.value&&editlist){var l=orderList.get({id:idField.value});Array.from(l).forEach((function(e){isid=(new DOMParser).parseFromString(e._values.id,"text/html"),isid.body.firstElementChild.innerHTML==itemId&&e.values({id:'<a href="javascript:void(0);" class="fw-medium link-primary">'+idField.value+"</a>",customer_name:customerNameField.value,product_name:productNameField.value,order_date:createDateField.value,delivery_date:deliveryDateField.value,amount:amountField.value,payment:paymentField.value,status:isStatus(statusField.value)})})),document.getElementById("alert-error-msg").classList.add("d-none"),document.getElementById("close-modal").click(),clearFields(),Swal.fire({position:"center",icon:"success",title:"Order updated Successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0})}}else orderList.add({id:'<a href="javascript:void(0);" class="fw-medium link-primary">#TBT'+count+"</a>",customer_name:customerNameField.value,product_name:productNameField.value,amount:"$"+amountField.value,order_date:createDateField.value,delivery_date:deliveryDateField.value,payment_method:paymentField.value,status:isStatus(statusField.value)}),orderList.sort("id",{order:"desc"}),document.getElementById("alert-error-msg").classList.add("d-none"),document.getElementById("close-modal").click(),clearFields(),refreshCallbacks(),count++,Swal.fire({position:"center",icon:"success",title:"Order inserted successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0});return!0}))})),document.getElementById("showModal").addEventListener("hidden.bs.modal",(function(){clearFields()})),document.querySelector(".pagination-next").addEventListener("click",(function(){document.querySelector(".pagination.listjs-pagination")&&(document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").nextElementSibling.children[0].click())})),document.querySelector(".pagination-prev").addEventListener("click",(function(){document.querySelector(".pagination.listjs-pagination")&&(document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").previousSibling.children[0].click())}));